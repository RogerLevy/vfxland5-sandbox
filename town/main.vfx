builtin-font fnt! \ TODO: where to call this??

REQUIRE %vfxland5%/supershow/actor.vfx
REQUIRE %vfxland5%/supershow/stage.vfx
REQUIRE %vfxland5%/supershow/sprites.vfx
REQUIRE %vfxland5%/supershow/mode.vfx

REQUIRE %idir%/../scrolling.vfx
REQUIRE %idir%/../tiled.vfx

JSONFILE %idir%/onett.tmj

onett.tmj LEVEL onett.lvl  fg bg
1 onett.lvl >sprlayer# !

REQUIRE %idir%/../obj/blobby/blobby.vfx

EC-CELL lvl

%actor dmake VALUE p1

|| 0 VALUE zbuf
: findtag ( z$ - actor|0 )
    to zbuf   who> zbuf zcount tag$ count s= ;

: town
    onett.tmj "objects" load-to-stage
    onett.lvl lvl! 
    \ 158 13   16 16 2*  2>p scrollx 2!
    "mychar" findtag ?dup if to p1  p1 freemove then
;

: game
    work>
        step
        p1 { x 2@ gamew gameh 2 2 2/ 2>p 2- scrollx 2! }
    show>
        lvl@ draw
        0 0 at s{ scrollx 2@ 2>i swap . . s} print
;

town game
