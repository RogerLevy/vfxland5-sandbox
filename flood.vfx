|| variable areacolor 
|| 0 value b
|| variable tempcolor 
|| 0 value w
|| 0 value h

: (flood-fill)   ( x y -- )
    {: x y :}
    x 0< ?exit
    y 0< ?exit
    x w >= ?exit
    y h >= ?exit
    b x y pixel@ tempcolor !
    tempcolor @ areacolor @ = if
        x y at pixel
        x 1 + y recurse
        x y 1 + recurse
        x 1 - y recurse
        x y 1 - recurse
    then ;

: floodfill
    al_get_target_bitmap to b
    b at@ pixel@ rgba8@ = ?exit
    b albmpw to w
    b albmph to h
    b at@ pixel@ areacolor !
    e{ at@ (flood-fill) e} ;
