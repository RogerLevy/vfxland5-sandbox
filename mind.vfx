REQUIRE %idir%/element.vfx
REQUIRE %vfxland5%/supershow/stage.vfx

class: %actor
    prop mind :ref %element         \ points to micro machine root
    prop mindsrc :lstring <save     \ template file: "enemy-ai.json"
class;

class: %stage
    prop org :ref %element          \ scene GUI - minds, notes, debug viz
class;

%actor :: unload
    mind @ ?dup if unload mind off then  \ unload mind tree when actor dies
    actor:unload ;

class: %element
    prop bod \ :ref %actor
class;

: it's-alive ( element actor - )
    2dup >mind ! swap >bod ! ;

\ : init-mind ( actor - ) 
\     as>
\     mind @ -exit  \ mind already exists (from save state), skip
\     mindsrc @ ?dup if
\         lcount load-tree   dup desktop @ push   me it's-alive
\     then ;
